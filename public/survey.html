<!DOCTYPE html>
<html>
    <head>
        <meta "content-type" content="text/html; charset=utf-8">
        <title>Friend Finder</title>
        <!-- Jquery -->
        <script src="/jquery/dist/jquery.js"></script>
        <!-- Bootstrap -->
        <link rel="stylesheet" href="/bootstrap/dist/css/bootstrap.css">
        <script src="/bootstrap/dist/js/bootstrap.js"></script>
        <!-- Font Awesome -->
        <link rel="stylesheet" href="/font-awesome/css/font-awesome.css">
	    <!-- Chosen -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.css">
	    <script src="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.jquery.min.js"></script>
    </head>
    <body>

        <div class="container">
            <h2>Survey Questions</h2>
            <hr>

            <h3 style="font-weight: bold">About You</h3>
            <h4>Name (Required)</h4>
            <input type="text" name="name" id="name" class="form-control" required>

            <h4>Link to Portrait Image (Required)</h4>
            <input type="text" name="photo" id="photo" class="form-control" required>
            <hr>

            <!-->Questions<-->
            <h3 style="font-weight: bold">Question 1</h3>
            <h4>Chocolate is the best flavor of ice cream</h4>
            <select data-placeholder="" class="chosen-select" id="q1">
                <option value=""></option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>
            
            <h3 style="font-weight: bold">Question 2</h3>
            <h4>You only use Kleenex brand facial tissues</h4>
            <select data-placeholder="" class="chosen-select" id="q2">
                <option value=""></option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>
            
            <h3 style="font-weight: bold">Question 3</h3>
            <h4>Donald Trump is the worst president in US history</h4>
            <select data-placeholder="" class="chosen-select" id="q3">
                <option value=""></option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>
            
            <h3 style="font-weight: bold">Question 4</h3>
            <h4>Sex on the xth date?</h4>
            <select data-placeholder="" class="chosen-select" id="q4" style="width: 23%">
                <option value=""></option>
                <option value="1">1st</option>
                <option value="2">2nd</option>
                <option value="3">3rd</option>
                <option value="4">4th</option>
                <option value="5">5th</option>
            </select>
            
            <h3 style="font-weight: bold">Question 5</h3>
            <h4>Meat is murder</h4>
            <select data-placeholder="" class="chosen-select" id="q5">
                <option value=""></option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>
            
            <h3 style="font-weight: bold">Question 6</h3>
            <h4>Jesus is our lord and savior</h4>
            <select data-placeholder="" class="chosen-select" id="q6">
                <option value=""></option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>
            
            <h3 style="font-weight: bold">Question 7</h3>
            <h4>You tend to do things "before it's cool"</h4>
            <select data-placeholder="" class="chosen-select" id="q7">
                <option value=""></option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>
            
            <h3 style="font-weight: bold">Question 8</h3>
            <h4>You wear white after Labor Day</h4>
            <select data-placeholder="" class="chosen-select" id="q8">
                <option value=""></option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>
            
            <h3 style="font-weight: bold">Question 9</h3>
            <h4>You have done, or are willing to try a threesome</h4>
            <select data-placeholder="" class="chosen-select" id="q9">
                <option value=""></option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>
            
            <h3 style="font-weight: bold">Question 10</h3>
            <h4>The Oreo really is America's favorite cookie</h4>
            <select data-placeholder="" class="chosen-select" id="q10">
                <option value=""></option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
            </select>

            <br><br>

            <button type="submit" class="btn btn-primary btn-lg btn-block" id="submit"<i class="fa fa-upload" aria-hidden="true"></i> Submit</button>
            <hr>
            <!-->View JSON of users or GitHub page, same as index.html<-->
            <footer class="footer">
                <div class="containter">
                    <p style="margin-left: -12px"><a href="/api/friends">API Friends List</a> | <a href="https://github.com/burningserenity/FriendFinder">GitHub Repo</a></p>
                </div>
            </footer>
        </div>

        <!-->Modal showing the best match as per the survey<-->
        <div id="resultsModal" class="modal fade" role="dialog">
            <div class="modal-dialog" style="background-color: azure">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h2 class="modal-title" style="font-weight: bold">Best Match</h2>
                </div>
                <div class="modal-body">
                    <h2 id="matchName"></h2>
                    <img id="matchImg" src="https://media.licdn.com/mpr/mpr/shrinknp_400_400/p/6/005/064/1bd/3435aa3.jpg" alt="">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
        
        <script type="text/javascript">

            // Chosen
            var config = {
                '.chosen-select' : {},
                '.chosen-select-deselect' : {allow_single_deselect: true},
                '.chosen-select-no-single' : {disable_search_threshold: 10},
                '.chosen-select-no-results' : {no_results_text: 'Oops, nothing found!'},
                '.chosen-select-width' : {width: "95%"}
            }
            for (var selector in config) {
                $(selector).chosen(config[selector]);
            }

            // Get user input
            $("#submit").on("click", function() {
                function validateForm() {
                    var isValid = true;
                    $('.form-control').each(function() {
                        if ($(this).val() === '') isValid = false;
                    });
                    return isValid;
                }

                if (validateForm() == true) {
                    var userData = {
                        name: $("#name").val(),
                        photo: $("#photo").val(),
                        scores: [$("#q1").val(), $("#q2").val(), $("#q3").val(), $("#q4").val(), $("#q5").val(), $("#q6").val(), $("#q7").val(), $("#q8").val(), $("#q9").val(), $("#q10").val()]
                    }

                    for (i = 0; i < 10; i++) {
                        if (userData.scores[i] < 1 || userData.scores[i] == undefined) {
                            alert("Please answer all questions before submitting!");
                            return false;
                        }
                    }

                    var currentURL = window.location.origin;

                    // Add new user to JSON object

                    $.post(currentURL + "/api/friends", userData, function(data) {
                        $("#matchName").text(data.name);
                        $("#matchImg").attr("src", data.photo);
                        $("#resultsModal").modal("toggle");
                    });
                }
                else alert("Please fill out all fields before submitting!");

                return false;
            });

        </script>
    </body>
</html>
